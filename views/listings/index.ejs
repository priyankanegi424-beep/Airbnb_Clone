<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WonderLust</title>
</head> -->
<% layout("/layouts/boilerplate") %> <!-- is layout use karne se html ka set custome boilerplate milta h -->
    <!-- <h3>All Listings</h3> -->
    <!-- comment create new listing button this is use on navbar -->
    <!-- <form method="get" action="/listings/new">
        <button>Create New Listing</button>
    </form> -->
    <link rel="stylesheet" href="/css/stayvel_homepage.css">

    <link rel="stylesheet" href="/css/filter.css">
    <link rel="stylesheet" href="/css/filter.css">

    <div class="filters-main">

        <!-- ONLY 2 FILTER BUTTONS -->
        <div id="filters" style="display:flex; gap:14px; align-items:center;">

            <a href="/listings/filter/Iconic Cities">
                <div class="filter Iconic-cities">
                    <div>
                        <img src="/Icon/21.png" alt="icon" style="width:25px;height:25px;">
                    </div>
                    <p>Farmhouses & Stays</p>
                </div>
            </a>

            <a href="/listings/filter/Earth Homes">
                <div class="filter Earth-homes">
                    <div>
                        <img src="/Icon/22.png" alt="icon" style="width:25px;height:25px;">
                    </div>
                    <p>Hotel & Resorts</p>
                </div>
            </a>


            <!-- ================= DOZZY STYLE FILTERS (INDEX.EJS) ================= -->

<div class="dozzy-index-filters">

  <!-- BHK -->
  <div class="filter-dd">
    <button type="button" class="filter-btn" id="bhkBtn">All BHK</button>
    <ul class="filter-menu" id="bhkMenu">
      <li data-bhk="1">1 BHK</li>
      <li data-bhk="2">2 BHK</li>
      <li data-bhk="3">3 BHK</li>
      <li data-bhk="4">4 BHK</li>
      <li data-bhk="5">5 BHK</li>
      <li data-bhk="6">6 BHK</li>
      <li data-bhk="7">7 BHK</li>
    </ul>
  </div>

  <!-- PRICE -->
  <div class="filter-dd">
    <button type="button" class="filter-btn" id="priceBtn">All Prices</button>
    <ul class="filter-menu" id="priceMenu">
      <li data-price="6000-8000">₹6k – ₹8k</li>
      <li data-price="8000-10000">₹8k – ₹10k</li>
      <li data-price="10000-12000">₹10k – ₹12k</li>
      <li data-price="12000-14000">₹12k – ₹14k</li>
    </ul>
  </div>

  <!-- SORT -->
  <div class="filter-dd">
    <button type="button" class="filter-btn" id="sortBtn">Sort</button>
    <ul class="filter-menu" id="sortMenu">
      <li data-sort="low">Low to High</li>
      <li data-sort="high">High to Low</li>
    </ul>
  </div>

  <!-- CLEAR -->
  <button type="button" class="clear-filter" id="clearFilters">
    Clear All Filters ✖
  </button>

</div>


        </div>

        

        <!-- FILTER ICON (KEEP THIS) -->
        <!-- <div class="tax-toggle tax-filter-icon filterIcon me-2 ms-2" onclick="filterClick()">
            <div class="form-check form-switch form-check-reverse pe-1" style="cursor:pointer;">
                <i class="fa-solid fa-sliders" id="filter-icon"></i>
                <label class="form-check-label" style="cursor:pointer;">Filters</label>
            </div>
        </div> -->

        <!-- DISPLAY TOTAL BEFORE TAXES (COMMENTED, NOT REMOVED) -->
        <!--
    <div class="tax-toggle tax-filter">
        <div class="form-check form-switch form-check-reverse">
            <input class="form-check-input tax-switch shadow-none" type="checkbox" role="switch">
            <label class="form-check-label changeAfter">Display total before taxes</label>
        </div>
    </div>
    -->

    </div>

    <div class="row row-cols-xxl-4 row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-1">
        <% for (const listing of allListing) { %>
            <a href="/listings/<%= listing._id %>" class="listing-link">
                <div class="card col listing-card index-res">
                    <div class="index-res-img">
                        <div class="card-img">
                            <img class="heart heart-r" src="/Icon/heart-red.png" alt="like"
                                style="opacity: 1; z-index: 5;">
                            <img class="heart heart-b" src="/Icon/heart-black.png" alt="like" style="z-index: 6;">
                            <% if (listing.images && listing.images.length> 0) { %>
                                <img src="<%= listing.images[0].url %>" class="card-img-top" alt="listing_image" />
                                <% } else if (listing.image && listing.image.url) { %>
                                    <!-- fallback for old listings -->
                                    <% if (listing.images && listing.images.length> 0) { %>
                                        <img src="<%= listing.images[0].url %>" class="card-img-top"
                                            alt="listing_image">
                                        <% } else { %>
                                            <img src="/images/default-image.jpg" class="card-img-top"
                                                alt="listing_image">
                                            <% } %>

                                                <% } else { %>
                                                    <img src="/Icon/no-image.png" class="card-img-top" alt="no image" />
                                                    <% } %>

                        </div>
                        <!-- set date  -->
                        <% let day=Math.floor(Math.random() * 4 + 2); let no=Math.floor(Math.random() * 28 + 1); let
                            date=(new Date('2024-09-10')).getDate() + no; let dateA=(new Date('2024-09-10')).getDate() +
                            no + day; let month=Date().split(" ")[1];
                         %>
                        <div class=" card-body mt-1 ms-2">
                            <p class="card-text" style="display: block;">
                                <b>
                                    <%= listing.title %>
                                </b> <br>
                                <span>&nbsp;<%= listing.location %>, <%= listing.country %></span>
                                <span style="display: block;"><span class="tax-info">&nbsp;<%= day %> nights •</span>
                                    &nbsp;<%= date %>-<%- dateA %> &nbsp;&nbsp;<%= month %></span>
                                <span class="price-info"><span class=" fw-bold">&nbsp;&#8377;<%=
                                            listing.price.toLocaleString("en-IN") %> </span> night</span>
                                <i class="tax-info tax-underline ms-1"><i class="rs-sign"><b> &#8377;</i>
                                    <%= (listing.price*1.18).toLocaleString("en-In") %></b> &nbsp;total after taxes
                                </i>
                            </p>
                    </div>
                </div>
    </div>
    </a>
    <% } %>
        </div>



        
        <script defer src="/js/filter.js"></script>
        <script src="/js/navbar-filter.js"></script>


        <script>
            // let heartR = document.querySelectorAll(".heart-r")
            // let heartB = document.querySelectorAll(".heart-b")
            // for (const heartb of heartB) {
            //     heartb.addEventListener("click", ()=>{
            //         heartb.style.zIndex = "4"
            //     })
            // }
            // for (const heartr of heartR) {
            //     heartr.addEventListener("click", ()=>{
            //         heartr.style.zIndex = "3"
            //     })
            // }

            // let heart1 = document.querySelectorAll(".heart")
            // // for (const heart1 of heart) {
            // for(let i = 1; i<  heart1.length; i++){
            //     console.log(heart1[i])
            //     heart1[i].addEventListener("click", ()=>{
            //         // console.log(`click heart: ${heart1[i]}`)
            //     // heart1.addEventListener("click", ()=>{
            //     //     for (const h of heart1) {
            //     //         // console.log(h)
            //     //         h[0].style.zIndex = "4"
            //     //         h[1].style.zIndex = "3"
            //     //     }
            //     })
            // }

        </script>